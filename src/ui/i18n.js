// --- åœ‹éš›åŒ– (i18n) - ç¹ä¸­ã€ç°¡ä¸­ã€è‹±æ–‡ ---
export const I18N = {
    _lang: null,

    // èªè¨€å­—å…¸
    strings: {
        'zh-TW': {
            title: 'YouTube æ·¨åŒ–å¤§å¸«',
            menu_rules: 'ğŸ“‚ è¨­å®šéæ¿¾è¦å‰‡',
            menu_low_view: 'ä½è§€çœ‹æ•¸éæ¿¾ (å«ç›´æ’­)',
            menu_threshold: 'ğŸ”¢ è¨­å®šé–¾å€¼',
            menu_advanced: 'ğŸš« é€²éšéæ¿¾',
            menu_new_tab: 'å¼·åˆ¶æ–°åˆ†é  (å½±ç‰‡)',
            menu_notification_new_tab: 'å¼·åˆ¶æ–°åˆ†é  (é€šçŸ¥)',
            menu_debug: 'Debug',
            menu_reset: 'ğŸ”„ æ¢å¾©é è¨­',
            menu_stats: 'ğŸ“Š éæ¿¾çµ±è¨ˆ',
            menu_export: 'ğŸ’¾ åŒ¯å‡º/åŒ¯å…¥è¨­å®š',
            menu_lang: 'ğŸŒ èªè¨€',
            menu_input: 'è¼¸å…¥é¸é …:',
            stats_title: 'ã€ éæ¿¾çµ±è¨ˆ ã€‘',
            stats_empty: 'å°šæœªéæ¿¾ä»»ä½•å…§å®¹',
            stats_filtered: 'å·²éæ¿¾ {0} å€‹é …ç›®',
            export_title: 'ã€ è¨­å®šç®¡ç† ã€‘',
            export_export: 'ğŸ“¤ åŒ¯å‡ºè¨­å®š',
            export_import: 'ğŸ“¥ åŒ¯å…¥è¨­å®š',
            export_success: 'âœ… è¨­å®šå·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼',
            export_copy: 'è«‹è¤‡è£½ä»¥ä¸‹è¨­å®š (Ctrl+C):',
            import_prompt: 'è«‹è²¼ä¸Šè¨­å®š JSON:',
            import_success: 'âœ… è¨­å®šå·²æˆåŠŸåŒ¯å…¥ï¼',
            import_fail: 'âŒ åŒ¯å…¥å¤±æ•—: ',
            rules_title: 'ã€ éæ¿¾è¦å‰‡ ã€‘',
            rules_back: '(0 è¿”å›)',
            threshold_prompt: 'é–¾å€¼:',
            reset_confirm: 'é‡è¨­?',
            lang_title: 'ã€ é¸æ“‡èªè¨€ ã€‘',
            back: 'è¿”å›',
            adv_keyword_filter: 'é—œéµå­—éæ¿¾',
            adv_keyword_list: 'âœï¸ é—œéµå­—æ¸…å–®',
            adv_channel_filter: 'é »é“éæ¿¾',
            adv_channel_list: 'âœï¸ é »é“æ¸…å–®',
            adv_duration_filter: 'é•·åº¦éæ¿¾',
            adv_duration_set: 'â±ï¸ è¨­å®šé•·åº¦',
            adv_min: 'æœ€çŸ­(åˆ†):',
            adv_max: 'æœ€é•·(åˆ†):',
            adv_add: 'æ–°å¢',
            adv_remove: 'åˆªé™¤',
            adv_clear: 'æ¸…ç©º',
            adv_region_convert: 'ç¹ç°¡é€šç”¨éæ¿¾'
        },
        'zh-CN': {
            title: 'YouTube å‡€åŒ–å¤§å¸ˆ',
            menu_rules: 'ğŸ“‚ è®¾ç½®è¿‡æ»¤è§„åˆ™',
            menu_low_view: 'ä½è§‚çœ‹æ•°è¿‡æ»¤ (å«ç›´æ’­)',
            menu_threshold: 'ğŸ”¢ è®¾ç½®é˜ˆå€¼',
            menu_advanced: 'ğŸš« é«˜çº§è¿‡æ»¤',
            menu_new_tab: 'å¼ºåˆ¶æ–°æ ‡ç­¾é¡µ (è§†é¢‘)',
            menu_notification_new_tab: 'å¼ºåˆ¶æ–°æ ‡ç­¾é¡µ (é€šçŸ¥)',
            menu_debug: 'Debug',
            menu_reset: 'ğŸ”„ æ¢å¤é»˜è®¤',
            menu_stats: 'ğŸ“Š è¿‡æ»¤ç»Ÿè®¡',
            menu_export: 'ğŸ’¾ å¯¼å‡º/å¯¼å…¥è®¾ç½®',
            menu_lang: 'ğŸŒ è¯­è¨€',
            menu_input: 'è¾“å…¥é€‰é¡¹:',
            stats_title: 'ã€ è¿‡æ»¤ç»Ÿè®¡ ã€‘',
            stats_empty: 'å°šæœªè¿‡æ»¤ä»»ä½•å†…å®¹',
            stats_filtered: 'å·²è¿‡æ»¤ {0} ä¸ªé¡¹ç›®',
            export_title: 'ã€ è®¾ç½®ç®¡ç† ã€‘',
            export_export: 'ğŸ“¤ å¯¼å‡ºè®¾ç½®',
            export_import: 'ğŸ“¥ å¯¼å…¥è®¾ç½®',
            export_success: 'âœ… è®¾ç½®å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼',
            export_copy: 'è¯·å¤åˆ¶ä»¥ä¸‹è®¾ç½® (Ctrl+C):',
            import_prompt: 'è¯·ç²˜è´´è®¾ç½® JSON:',
            import_success: 'âœ… è®¾ç½®å·²æˆåŠŸå¯¼å…¥ï¼',
            import_fail: 'âŒ å¯¼å…¥å¤±è´¥: ',
            rules_title: 'ã€ è¿‡æ»¤è§„åˆ™ ã€‘',
            rules_back: '(0 è¿”å›)',
            threshold_prompt: 'é˜ˆå€¼:',
            reset_confirm: 'é‡ç½®?',
            lang_title: 'ã€ é€‰æ‹©è¯­è¨€ ã€‘',
            back: 'è¿”å›',
            adv_keyword_filter: 'å…³é”®å­—è¿‡æ»¤',
            adv_keyword_list: 'âœï¸ å…³é”®å­—åˆ—è¡¨',
            adv_channel_filter: 'é¢‘é“è¿‡æ»¤',
            adv_channel_list: 'âœï¸ é¢‘é“åˆ—è¡¨',
            adv_duration_filter: 'æ—¶é•¿è¿‡æ»¤',
            adv_duration_set: 'â±ï¸ è®¾ç½®æ—¶é•¿',
            adv_min: 'æœ€çŸ­(åˆ†):',
            adv_max: 'æœ€é•¿(åˆ†):',
            adv_add: 'æ–°å¢',
            adv_remove: 'åˆ é™¤',
            adv_clear: 'æ¸…ç©º',
            adv_region_convert: 'ç¹ç®€é€šç”¨è¿‡æ»¤'
        },
        'en': {
            title: 'YouTube Cleaner',
            menu_rules: 'ğŸ“‚ Filter Rules',
            menu_low_view: 'Low View Filter (incl. Live)',
            menu_threshold: 'ğŸ”¢ Set Threshold',
            menu_advanced: 'ğŸš« Advanced Filters',
            menu_new_tab: 'Force New Tab (Video)',
            menu_notification_new_tab: 'Force New Tab (Notif)',
            menu_debug: 'Debug',
            menu_reset: 'ğŸ”„ Reset to Default',
            menu_stats: 'ğŸ“Š Filter Stats',
            menu_export: 'ğŸ’¾ Export/Import Settings',
            menu_lang: 'ğŸŒ Language',
            menu_input: 'Enter option:',
            stats_title: 'ã€ Filter Statistics ã€‘',
            stats_empty: 'No content filtered yet',
            stats_filtered: 'Filtered {0} items',
            export_title: 'ã€ Settings Management ã€‘',
            export_export: 'ğŸ“¤ Export Settings',
            export_import: 'ğŸ“¥ Import Settings',
            export_success: 'âœ… Settings copied to clipboard!',
            export_copy: 'Copy settings (Ctrl+C):',
            import_prompt: 'Paste settings JSON:',
            import_success: 'âœ… Settings imported successfully!',
            import_fail: 'âŒ Import failed: ',
            rules_title: 'ã€ Filter Rules ã€‘',
            rules_back: '(0 Back)',
            threshold_prompt: 'Threshold:',
            reset_confirm: 'Reset?',
            lang_title: 'ã€ Select Language ã€‘',
            back: 'Back',
            adv_keyword_filter: 'Keyword Filter',
            adv_keyword_list: 'âœï¸ Keyword List',
            adv_channel_filter: 'Channel Filter',
            adv_channel_list: 'âœï¸ Channel List',
            adv_duration_filter: 'Duration Filter',
            adv_duration_set: 'â±ï¸ Set Duration',
            adv_min: 'Min (min):',
            adv_max: 'Max (min):',
            adv_add: 'Add',
            adv_remove: 'Remove',
            adv_clear: 'Clear',
            adv_region_convert: 'Region Agnostic Filter'
        }
    },

    // è¦å‰‡åç¨±ç¿»è­¯
    ruleNames: {
        'zh-TW': {
            ad_block_popup: 'å»£å‘Šé˜»æ“‹å½ˆçª—',
            ad_sponsor: 'å»£å‘Š/è´ŠåŠ©',
            members_only: 'æœƒå“¡å°ˆå±¬',
            shorts_item: 'Shorts é …ç›®',
            mix_only: 'åˆè¼¯',
            premium_banner: 'Premium æ©«å¹…',
            news_block: 'æ–°èå€å¡Š',
            shorts_block: 'Shorts å€å¡Š',
            posts_block: 'ç¤¾ç¾¤è²¼æ–‡',
            playables_block: 'å¯ç©å…§å®¹',
            fundraiser_block: 'å‹Ÿæ¬¾æ´»å‹•',
            shorts_grid_shelf: 'Shorts ç¶²æ ¼',
            movies_shelf: 'é›»å½±æ¨è–¦',
            youtube_featured_shelf: 'YouTube ç²¾é¸',
            popular_gaming_shelf: 'ç†±é–€éŠæˆ²',
            more_from_game_shelf: 'æ›´å¤šéŠæˆ²å…§å®¹',
            trending_playlist: 'ç†±é–€æ’­æ”¾æ¸…å–®',
            inline_survey: 'å•å·èª¿æŸ¥',
            clarify_box: 'è³‡è¨Šæ¡†',
            explore_topics: 'æ¢ç´¢ä¸»é¡Œ',
            recommended_playlists: 'æ¨è–¦æ’­æ”¾æ¸…å–®',
            members_early_access: 'æœƒå“¡æ¶å…ˆçœ‹'
        },
        'zh-CN': {
            ad_block_popup: 'å¹¿å‘Šæ‹¦æˆªå¼¹çª—',
            ad_sponsor: 'å¹¿å‘Š/èµåŠ©',
            members_only: 'ä¼šå‘˜ä¸“å±',
            shorts_item: 'Shorts é¡¹ç›®',
            mix_only: 'åˆè¾‘',
            premium_banner: 'Premium æ¨ªå¹…',
            news_block: 'æ–°é—»åŒºå—',
            shorts_block: 'Shorts åŒºå—',
            posts_block: 'ç¤¾åŒºå¸–å­',
            playables_block: 'å¯ç©å†…å®¹',
            fundraiser_block: 'å‹Ÿæ¬¾æ´»åŠ¨',
            shorts_grid_shelf: 'Shorts ç½‘æ ¼',
            movies_shelf: 'ç”µå½±æ¨è',
            youtube_featured_shelf: 'YouTube ç²¾é€‰',
            popular_gaming_shelf: 'çƒ­é—¨æ¸¸æˆ',
            more_from_game_shelf: 'æ›´å¤šæ¸¸æˆå†…å®¹',
            trending_playlist: 'çƒ­é—¨æ’­æ”¾åˆ—è¡¨',
            inline_survey: 'é—®å·è°ƒæŸ¥',
            clarify_box: 'ä¿¡æ¯æ¡†',
            explore_topics: 'æ¢ç´¢ä¸»é¢˜',
            recommended_playlists: 'æ¨èæ’­æ”¾åˆ—è¡¨',
            members_early_access: 'ä¼šå‘˜æŠ¢å…ˆçœ‹'
        },
        'en': {
            ad_block_popup: 'Ad-block Popup',
            ad_sponsor: 'Ads / Sponsors',
            members_only: 'Members Only',
            shorts_item: 'Shorts Items',
            mix_only: 'Mix Playlists',
            premium_banner: 'Premium Banner',
            news_block: 'News Section',
            shorts_block: 'Shorts Section',
            posts_block: 'Community Posts',
            playables_block: 'Playables',
            fundraiser_block: 'Fundraiser',
            shorts_grid_shelf: 'Shorts Grid',
            movies_shelf: 'Movies Shelf',
            youtube_featured_shelf: 'YouTube Featured',
            popular_gaming_shelf: 'Popular Gaming',
            more_from_game_shelf: 'More from Games',
            trending_playlist: 'Trending Playlist',
            inline_survey: 'Surveys',
            clarify_box: 'Clarify Box',
            explore_topics: 'Explore Topics',
            recommended_playlists: 'Recommended Playlists',
            members_early_access: 'Members Early Access'
        }
    },

    getRuleName(ruleKey) {
        return this.ruleNames[this.lang]?.[ruleKey] || this.ruleNames['en'][ruleKey] || ruleKey;
    },

    detectLanguage() {
        const ytLang = document.documentElement.lang || navigator.language || 'zh-TW';
        if (ytLang.startsWith('zh-CN') || ytLang.startsWith('zh-Hans')) return 'zh-CN';
        if (ytLang.startsWith('zh')) return 'zh-TW';
        return 'en';
    },

    get lang() {
        if (!this._lang) {
            this._lang = GM_getValue('ui_language', null) || this.detectLanguage();
        }
        return this._lang;
    },

    set lang(value) {
        this._lang = value;
        GM_setValue('ui_language', value);
    },

    t(key, ...args) {
        const str = this.strings[this.lang]?.[key] || this.strings['en'][key] || key;
        return str.replace(/\{(\d+)\}/g, (_, i) => args[i] ?? '');
    },

    get availableLanguages() {
        return {
            'zh-TW': 'ç¹é«”ä¸­æ–‡',
            'zh-CN': 'ç®€ä½“ä¸­æ–‡',
            'en': 'English'
        };
    }
};
